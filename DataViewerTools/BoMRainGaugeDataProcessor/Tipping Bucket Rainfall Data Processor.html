<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Rainfall Data Analyser</title>
    <style>
      html, body {
        box-sizing: border-box;
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-3.1.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.1.1.min.js"></script>
    <script type="text/javascript">
        Bokeh.set_log_level("info");
    </script>
    
        <script type="text/javascript" src="MyCustomFunctions.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.0.0/papaparse.min.js"></script>
        
        <style>
    
            /* ---------- Page tabs styling -----------*/
            .bk-root .bk-tab {
                background-color: #15191C;
                color: white;
                opacity: 0.8;
                border-style: solid;
                outline_line_color: white;
            }
            
            .bk-root .bk-tabs-header .bk-tab.bk-active{
                background-color: lightskyblue;
                color: black;
                font-weight: bold;
                }
            
            .bk-root .bk-tabs-header .bk-tab:hover{
                background-color: lightsteelblue;
                }
            
            /* ---------- Font and Heading Styling -----------*/
            h1 {color: lightskyblue;}
            
            h2 {color: lightskyblue;}
            
            h3 {color: lightsteelblue;}
            
            body {
                background-color: #15191C;
                color: white;
                opacity: 0.8;
                }
            
            /* hyperlink styling */
            a:link {color: white;
                    }
            
            a:visited {color: white;
                       }
            
            a:hover {color: white;
                     }
            
            a:active {color: white;
                      }
            /* ------------ Toolbar icon styling ----------*/
            .bk-toolbar-button.bk-tool-icon-hover {display: none;}
            .bk-toolbar-button.bk-tool-icon-wheel-zoom {display: none;}
            .bk-toolbar-button.bk-tool-icon-tap-select {display: none;}
            .bk-toolbar-button.bk-tool-icon-pan {display: none;}
            
    
        </style>
  </head>
  <body>
    <div id="dc4007a9-e22b-4f5f-9925-bc715d4bd31c" data-root-id="p3507" style="display: contents;"></div>
  
    <script type="application/json" id="p3772">
      {"ff42662e-be0b-4ea8-a162-66fcd75703d8":{"version":"3.1.1","title":"Bokeh Application","defs":[],"roots":[{"type":"object","name":"Tabs","id":"p3507","attributes":{"tabs":[{"type":"object","name":"TabPanel","id":"p3328","attributes":{"title":"Rainfall Data Cleaner","child":{"type":"object","name":"Row","id":"p3327","attributes":{"children":[{"type":"object","name":"Column","id":"p3324","attributes":{"width":650,"children":[{"type":"object","name":"Div","id":"p3321","attributes":{"text":"&lt;h1&gt;Rain Gauge Data Cleaner&lt;/h1&gt;\n\n              &lt;p&gt;This app can be used to undertake a quality control analysis and cleaning of raw, tipping bucket type rain gauge data.&lt;/p&gt;\n              \n              &lt;ol&gt;\n                  &lt;li&gt;Upload the raw gauge data.&lt;/li&gt;\n                  &lt;ul&gt;\n                      &lt;li&gt;The input csv file should have two columns [DateTime, Rainfall] with DateTime having the format: dd/mm/yyyy HH:MM:SS (eg see '.csv' file produced by the bom2csv file formatter app).&lt;/li&gt;\n                      &lt;li&gt;The data is then automatically pre-cleaned for obvious anomalies and for duplicate timestamp entries.&lt;/li&gt;\n                  &lt;/ul&gt;\n                  &lt;br&gt;\n                  &lt;li&gt;Manual quality control and data cleaning&lt;/li&gt;\n                  &lt;ul&gt;\n                      &lt;li&gt;User can manually clean the data by selecting data points with the Box Select Tool in the top figure and then clicking the Delete Selected Points button.&lt;/li&gt;\n                      &lt;li&gt;If available, a daily rainfall reference data set (e.g. from SILO) can be uploaded to compare with the daily amounts estimated from the raw data. &lt;/li&gt; \n                   &lt;/ul&gt;\n                   &lt;br&gt;\n                  &lt;li&gt;Export the cleaned data&lt;/li&gt;\n                  &lt;ul&gt;\n                      &lt;li&gt;click the Export Cleaned Data button.&lt;/li&gt;\n                  &lt;/ul&gt;\n              &lt;/ol&gt;\n              \n              &lt;h2&gt;Open raw rain gauge file (.csv):&lt;/h2&gt;\n              &lt;p&gt;&lt;i&gt;Note: &lt;/i&gt;File must consist of two columns: &lt;br&gt; [DateTime, Gauge Rainfall] with DateTime formatted as 'dd/mm/yyyy HH:MM:SS'&lt;/p&gt;\n              \n              "}},{"type":"object","name":"FileInput","id":"p3305","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"type":"object","name":"CustomJS","id":"p3306","attributes":{"args":{"type":"map","entries":[["source_raw",{"type":"object","name":"ColumnDataSource","id":"p2855","attributes":{"selected":{"type":"object","name":"Selection","id":"p2857","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p2856"},"data":{"type":"map","entries":[["DateTime_Raw",[]],["Rainfall_Raw",[]]]}}}],["source_clean",{"type":"object","name":"ColumnDataSource","id":"p2858","attributes":{"selected":{"type":"object","name":"Selection","id":"p2860","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p2859"},"data":{"type":"map","entries":[["DateTime_Clean",[]],["Rainfall_Clean",[]],["Cumulative_Clean",[]]]}}}],["source_precleaned",{"type":"object","name":"ColumnDataSource","id":"p2861","attributes":{"selected":{"type":"object","name":"Selection","id":"p2863","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p2862"},"data":{"type":"map","entries":[["DateTime_Clean",[]],["Rainfall_Clean",[]],["Cumulative_Clean",[]]]}}}],["source_daily",{"type":"object","name":"ColumnDataSource","id":"p2867","attributes":{"selected":{"type":"object","name":"Selection","id":"p2869","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p2868"},"data":{"type":"map","entries":[["DateTime_Daily",[]],["Cumulative_Daily",[]],["Daily",[]]]}}}],["status_text_cleaner",{"type":"object","name":"TextInput","id":"p3128","attributes":{"width":400,"title":"Status:","value":"Waiting for file input."}}],["status_label_cleaner",{"type":"object","name":"Label","id":"p3127","attributes":{"text":"Waiting for file input.","text_color":"#E0E0E0","text_font":"Helvetica","text_font_size":"30px","text_align":"center","x":333,"x_units":"screen","y":200,"y_units":"screen"}}],["csvfile_input",{"id":"p3305"}],["plot_cleaner",{"type":"object","name":"Figure","id":"p3037","attributes":{"width":1000,"height":400,"x_range":{"type":"object","name":"DataRange1d","id":"p3039"},"y_range":{"type":"object","name":"DataRange1d","id":"p3038"},"x_scale":{"type":"object","name":"LinearScale","id":"p3051"},"y_scale":{"type":"object","name":"LinearScale","id":"p3053"},"title":{"type":"object","name":"Title","id":"p3040","attributes":{"text":" ","text_color":"#E0E0E0","text_font":"Helvetica","text_font_size":"1.15em"}},"outline_line_color":"#E0E0E0","outline_line_alpha":0.25,"renderers":[{"type":"object","name":"GlyphRenderer","id":"p3106","attributes":{"data_source":{"id":"p2855"},"view":{"type":"object","name":"CDSView","id":"p3107","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p3108"}}},"glyph":{"type":"object","name":"Line","id":"p3103","attributes":{"x":{"type":"field","field":"DateTime_Raw"},"y":{"type":"field","field":"Rainfall_Raw"},"line_color":"#1f77b4","line_width":2}},"nonselection_glyph":{"type":"object","name":"Line","id":"p3104","attributes":{"x":{"type":"field","field":"DateTime_Raw"},"y":{"type":"field","field":"Rainfall_Raw"},"line_color":"#1f77b4","line_alpha":0.1,"line_width":2}},"muted_glyph":{"type":"object","name":"Line","id":"p3105","attributes":{"x":{"type":"field","field":"DateTime_Raw"},"y":{"type":"field","field":"Rainfall_Raw"},"line_color":"#1f77b4","line_alpha":0.2,"line_width":2}}}},{"type":"object","name":"GlyphRenderer","id":"p3118","attributes":{"data_source":{"id":"p2858"},"view":{"type":"object","name":"CDSView","id":"p3119","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p3120"}}},"glyph":{"type":"object","name":"Circle","id":"p3115","attributes":{"x":{"type":"field","field":"DateTime_Clean"},"y":{"type":"field","field":"Rainfall_Clean"},"line_color":{"type":"value","value":"#ff7f0e"},"fill_color":{"type":"value","value":"#ff7f0e"},"fill_alpha":{"type":"value","value":0},"hatch_color":{"type":"value","value":"#ff7f0e"}}},"nonselection_glyph":{"type":"object","name":"Circle","id":"p3116","attributes":{"x":{"type":"field","field":"DateTime_Clean"},"y":{"type":"field","field":"Rainfall_Clean"},"line_color":{"type":"value","value":"#ff7f0e"},"line_alpha":{"type":"value","value":0.1},"fill_color":{"type":"value","value":"#ff7f0e"},"fill_alpha":{"type":"value","value":0.1},"hatch_color":{"type":"value","value":"#ff7f0e"},"hatch_alpha":{"type":"value","value":0.1}}},"muted_glyph":{"type":"object","name":"Circle","id":"p3117","attributes":{"x":{"type":"field","field":"DateTime_Clean"},"y":{"type":"field","field":"Rainfall_Clean"},"line_color":{"type":"value","value":"#ff7f0e"},"line_alpha":{"type":"value","value":0.2},"fill_color":{"type":"value","value":"#ff7f0e"},"fill_alpha":{"type":"value","value":0.2},"hatch_color":{"type":"value","value":"#ff7f0e"},"hatch_alpha":{"type":"value","value":0.2}}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p3043","attributes":{"logo":null,"tools":[{"type":"object","name":"PanTool","id":"p3069"},{"type":"object","name":"BoxZoomTool","id":"p3070","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p3071","attributes":{"syncable":false,"level":"overlay","visible":false,"left_units":"canvas","right_units":"canvas","bottom_units":"canvas","top_units":"canvas","line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}},{"type":"object","name":"WheelZoomTool","id":"p3072"},{"type":"object","name":"ResetTool","id":"p3073"},{"type":"object","name":"HoverTool","id":"p3110","attributes":{"renderers":[{"id":"p3106"}],"tooltips":[["Date Time","@DateTime_Raw{%H:%M %d/%m/%Y}"],["Rainfall_Raw","@Rainfall_Raw"]],"formatters":{"type":"map","entries":[["@DateTime_Raw","datetime"]]}}},{"type":"object","name":"HoverTool","id":"p3122","attributes":{"renderers":[{"id":"p3118"}],"tooltips":[["Date Time","@DateTime_Clean{%H:%M %d/%m/%Y}"],["Rainfall_Clean","@Rainfall_Clean"]],"formatters":{"type":"map","entries":[["@DateTime_Clean","datetime"]]}}},{"type":"object","name":"BoxSelectTool","id":"p3124","attributes":{"renderers":[{"id":"p3118"}],"overlay":{"type":"object","name":"BoxAnnotation","id":"p3125","attributes":{"syncable":false,"level":"overlay","visible":false,"editable":true,"line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}}],"active_drag":{"id":"p3070"},"active_scroll":{"id":"p3072"}}},"left":[{"type":"object","name":"LinearAxis","id":"p3062","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p3064","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p3063"},"axis_label":"Raw Gauge Data","axis_label_standoff":10,"axis_label_text_color":"#E0E0E0","axis_label_text_font":"Helvetica","axis_label_text_font_size":"1.25em","axis_label_text_font_style":"normal","major_label_policy":{"type":"object","name":"AllLabels","id":"p3065"},"major_label_text_color":"#E0E0E0","major_label_text_font":"Helvetica","major_label_text_font_size":"1.025em","axis_line_color":"#E0E0E0","axis_line_alpha":0,"major_tick_line_color":"#E0E0E0","major_tick_line_alpha":0,"minor_tick_line_color":"#E0E0E0","minor_tick_line_alpha":0}}],"right":[{"type":"object","name":"Legend","id":"p3099","attributes":{"border_line_alpha":0,"background_fill_color":"#20262B","background_fill_alpha":0,"click_policy":"hide","label_text_color":"#E0E0E0","label_text_font":"Helvetica","label_text_font_size":"1.025em","label_standoff":8,"glyph_width":15,"spacing":8,"items":[{"type":"object","name":"LegendItem","id":"p3109","attributes":{"label":{"type":"value","value":"Rainfall_Raw"},"renderers":[{"id":"p3106"}]}},{"type":"object","name":"LegendItem","id":"p3121","attributes":{"label":{"type":"value","value":"Rainfall_Clean"},"renderers":[{"id":"p3118"}]}}]}}],"below":[{"type":"object","name":"LinearAxis","id":"p3055","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p3057","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"DatetimeTickFormatter","id":"p3080","attributes":{"minutes":"%H:%M %d/%m/%Y","hours":"%H:%M %d/%m/%Y","days":"%H:%M %d/%m/%Y","months":"%d/%m/%Y","years":"%d/%m/%Y"}},"axis_label_standoff":10,"axis_label_text_color":"#E0E0E0","axis_label_text_font":"Helvetica","axis_label_text_font_size":"1.25em","axis_label_text_font_style":"normal","major_label_policy":{"type":"object","name":"AllLabels","id":"p3058"},"major_label_text_color":"#E0E0E0","major_label_text_font":"Helvetica","major_label_text_font_size":"1.025em","axis_line_color":"#E0E0E0","axis_line_alpha":0,"major_tick_line_color":"#E0E0E0","major_tick_line_alpha":0,"minor_tick_line_color":"#E0E0E0","minor_tick_line_alpha":0}}],"center":[{"type":"object","name":"Grid","id":"p3061","attributes":{"axis":{"id":"p3055"},"grid_line_color":"#E0E0E0","grid_line_alpha":0.25,"minor_grid_line_color":"grey","minor_grid_line_alpha":0.1,"minor_grid_line_dash":[6]}},{"type":"object","name":"Grid","id":"p3068","attributes":{"dimension":1,"axis":{"id":"p3062"},"grid_line_color":"#E0E0E0","grid_line_alpha":0.25,"minor_grid_line_color":"grey","minor_grid_line_alpha":0.1,"minor_grid_line_dash":[6]}},{"id":"p3127"}],"background_fill_color":"#20262B","border_fill_color":"#15191C"}}]]},"code":"\n    \n        function StatusTextLoading(){\n            status_text_cleaner.value = 'Loading raw data file and pre-cleaning data ...'\n            status_label_cleaner.text = 'Loading raw data file and pre-cleaning data ...'\n            }\n        \n        function StatusTextComplete(){\n            status_text_cleaner.value = 'File import and pre-cleaning complete.'    \n            status_label_cleaner.text = ' '\n            }\n    \n    \n        // file loading ////////////////////////////////////////////////////\n        function process_file() {\n    \n            var file_contents = cb_obj.value;\n            \n            // read in entire file and decode text\n            const decoded_file_contents = atob(file_contents);\n            const file_lines = decoded_file_contents.split(\"\\n\");\n            \n            // initialise arrays        \n            var DateTime_Raw = [];\n            var Rainfall_Raw = [];\n            \n            // read the file data line by line   //////////////////////////////////\n            for (var i = 1; i &lt; file_lines.length; i++) {\n                \n                // read a line\n                var line = file_lines[i]\n                \n                // checks\n                if (line.trim().length === 0 || line.trim() === \"\") {continue}\n                \n                // get the time series data\n                var tmp = line.split(',')\n\n                var rain = parseFloat(tmp[1])\n                Rainfall_Raw.push(rain);\n\n                // parse date time\n                // tmp[0] = 4/07/2005 9:33\n                var datetime_string = tmp[0];\n                var date_parts = datetime_string.split(\" \")[0].split(\"/\");\n                var time_parts = datetime_string.split(\" \")[1].split(\":\");\n                var datetime = new Date(date_parts[2], date_parts[1] - 1, date_parts[0], time_parts[0], time_parts[1]);\n                datetime = Math.floor(datetime.getTime()) // unix timestamp\n                DateTime_Raw.push(datetime)\n                \n                } // end of line by line loop\n    \n            // create data source\n            source_raw.data = {DateTime_Raw: DateTime_Raw, Rainfall_Raw: Rainfall_Raw}; \n            source_raw.change.emit();\n\n            // automatic pre-cleaning to remove obvious anomalies /////////////////////////////\n            console.log('  Pre-clean data ...')\n            const inc_threshold = 2 //mm\n            const intensity_threshold = 200 // mm/hr\n            var DateTime_Clean = []\n            var Data_Clean = []\n            for (var ii=1; ii&lt;Rainfall_Raw.length-1; ii++){  // so note that the first and last values of raw data are dropped\n               \n                // get rainfall increment\n                const inc_back = Rainfall_Raw[ii] - Rainfall_Raw[ii-1]\n                const inc_forward = Rainfall_Raw[ii] - Rainfall_Raw[ii+1]\n                \n                // catch anomalous intensity\n                const inc_time = DateTime_Raw[ii+1]/3600000 - DateTime_Raw[ii]/3600000\n                const intensity = -inc_forward/inc_time\n                if (intensity &gt; intensity_threshold) {console.log('here33')\n                                                      console.log(DateTime_Raw[ii+1], intensity_threshold, intensity)\n                                                      continue}\n                \n    \n                //catch up down anomaly above trend\n                if (inc_back &gt; inc_threshold &amp;&amp; inc_forward &gt; inc_threshold) {continue}\n    \n                // catch down up anomaly below trend\n                if (inc_back &lt; -inc_threshold &amp;&amp; inc_forward &lt; -inc_threshold) {continue}\n    \n                // keep good data\n                DateTime_Clean.push(DateTime_Raw[ii])\n                Data_Clean.push(Rainfall_Raw[ii])\n                \n                } // end of ii for loop\n    \n            // remove non-unique values - keeps last occurrence ///////////////////\n            let numbers = DateTime_Clean; \n            let [uniqueWithLastOccurrence, indices] = getUniqueWithLastOccurrence(numbers);\n            DateTime_Clean = subsetArray(DateTime_Clean,indices)\n            Data_Clean = subsetArray(Data_Clean,indices)\n            \n            // compute cumulative /////////////////////////////////////////////////\n            var Cumulative_Clean = cumulative(Data_Clean)\n    \n            // update sources /////////////////////////////////////////////////////\n            source_clean.data = {DateTime_Clean: DateTime_Clean, Rainfall_Clean: Data_Clean, Cumulative_Clean: Cumulative_Clean};\n            source_clean.change.emit();\n            source_precleaned.data = source_clean.data;\n            source_precleaned.change.emit();\n    \n           /////////////////////////////////////////////////////////////////////////             \n            // compute daily accumulations via interpolation of curve\n            // day is to 9am, consistent with SILO\n            let [DateTime_Daily, Cumulative_Daily, Daily]  = ComputeDailyRainfall(DateTime_Clean, Cumulative_Clean);\n            \n            // update source_daily\n            source_daily.data = {DateTime_Daily: DateTime_Daily, Cumulative_Daily: Cumulative_Daily, Daily: Daily}; \n            source_daily.change.emit();\n            \n        }  // end of process_file function\n    \n        function CallbackTiming(){\n            setTimeout(StatusTextLoading,0);\n            plot_cleaner.title.text = csvfile_input.filename;\n            setTimeout(process_file, 1000);\n            setTimeout(StatusTextComplete, 1000);\n            }\n        \n        CallbackTiming()\n        \n    "}}]]]},"width":400,"accept":".csv"}},{"id":"p3128"},{"type":"object","name":"Spacer","id":"p3323"},{"type":"object","name":"Div","id":"p3322","attributes":{"text":"&lt;h2&gt;Open SILO daily rainfal reference data (.txt):&lt;/h2&gt;"}},{"type":"object","name":"FileInput","id":"p3319","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"type":"object","name":"CustomJS","id":"p3320","attributes":{"args":{"type":"map","entries":[["source_silo",{"type":"object","name":"ColumnDataSource","id":"p2870","attributes":{"selected":{"type":"object","name":"Selection","id":"p2872","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p2871"},"data":{"type":"map","entries":[["DateTime_Silo",[]],["DailyRainfall_Silo",[]]]}}}],["status_text_cleaner_silo",{"type":"object","name":"TextInput","id":"p3292","attributes":{"width":400,"title":"Status:","value":"Waiting for SILO file input."}}],["status_label_cleaner_silo",{"type":"object","name":"Label","id":"p3291","attributes":{"text":"Waiting for SILO file input.","text_color":"#E0E0E0","text_font":"Helvetica","text_font_size":"30px","text_align":"center","x":333,"x_units":"screen","y":100,"y_units":"screen"}}],["plot_Daily_cleaner",{"type":"object","name":"Figure","id":"p3216","attributes":{"width":1000,"height":200,"x_range":{"id":"p3039"},"y_range":{"type":"object","name":"DataRange1d","id":"p3218"},"x_scale":{"type":"object","name":"LinearScale","id":"p3229"},"y_scale":{"type":"object","name":"LinearScale","id":"p3231"},"title":{"type":"object","name":"Title","id":"p3219","attributes":{"text":" ","text_color":"#E0E0E0","text_font":"Helvetica","text_font_size":"1.15em"}},"outline_line_color":"#E0E0E0","outline_line_alpha":0.25,"renderers":[{"type":"object","name":"GlyphRenderer","id":"p3285","attributes":{"data_source":{"id":"p2870"},"view":{"type":"object","name":"CDSView","id":"p3286","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p3287"}}},"glyph":{"type":"object","name":"VBar","id":"p3282","attributes":{"x":{"type":"field","field":"DateTime_Silo"},"width":{"type":"value","value":86400000.0},"top":{"type":"field","field":"DailyRainfall_Silo"},"line_color":{"type":"value","value":"#ff9896"},"fill_color":{"type":"value","value":"#ff9896"},"fill_alpha":{"type":"value","value":0.2}}},"nonselection_glyph":{"type":"object","name":"VBar","id":"p3283","attributes":{"x":{"type":"field","field":"DateTime_Silo"},"width":{"type":"value","value":86400000.0},"top":{"type":"field","field":"DailyRainfall_Silo"},"line_color":{"type":"value","value":"#ff9896"},"line_alpha":{"type":"value","value":0.1},"fill_color":{"type":"value","value":"#ff9896"},"fill_alpha":{"type":"value","value":0.1},"hatch_alpha":{"type":"value","value":0.1}}},"muted_glyph":{"type":"object","name":"VBar","id":"p3284","attributes":{"x":{"type":"field","field":"DateTime_Silo"},"width":{"type":"value","value":86400000.0},"top":{"type":"field","field":"DailyRainfall_Silo"},"line_color":{"type":"value","value":"#ff9896"},"line_alpha":{"type":"value","value":0.2},"fill_color":{"type":"value","value":"#ff9896"},"fill_alpha":{"type":"value","value":0.2},"hatch_alpha":{"type":"value","value":0.2}}}}},{"type":"object","name":"GlyphRenderer","id":"p3299","attributes":{"data_source":{"id":"p2867"},"view":{"type":"object","name":"CDSView","id":"p3300","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p3301"}}},"glyph":{"type":"object","name":"VBar","id":"p3296","attributes":{"x":{"type":"field","field":"DateTime_Daily"},"width":{"type":"value","value":86400000.0},"top":{"type":"field","field":"Daily"},"line_color":{"type":"value","value":"#98df8a"},"fill_color":{"type":"value","value":"#98df8a"},"fill_alpha":{"type":"value","value":0.2}}},"nonselection_glyph":{"type":"object","name":"VBar","id":"p3297","attributes":{"x":{"type":"field","field":"DateTime_Daily"},"width":{"type":"value","value":86400000.0},"top":{"type":"field","field":"Daily"},"line_color":{"type":"value","value":"#98df8a"},"line_alpha":{"type":"value","value":0.1},"fill_color":{"type":"value","value":"#98df8a"},"fill_alpha":{"type":"value","value":0.1},"hatch_alpha":{"type":"value","value":0.1}}},"muted_glyph":{"type":"object","name":"VBar","id":"p3298","attributes":{"x":{"type":"field","field":"DateTime_Daily"},"width":{"type":"value","value":86400000.0},"top":{"type":"field","field":"Daily"},"line_color":{"type":"value","value":"#98df8a"},"line_alpha":{"type":"value","value":0.2},"fill_color":{"type":"value","value":"#98df8a"},"fill_alpha":{"type":"value","value":0.2},"hatch_alpha":{"type":"value","value":0.2}}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p3222","attributes":{"logo":null,"tools":[{"type":"object","name":"PanTool","id":"p3247"},{"type":"object","name":"BoxZoomTool","id":"p3248","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p3249","attributes":{"syncable":false,"level":"overlay","visible":false,"left_units":"canvas","right_units":"canvas","bottom_units":"canvas","top_units":"canvas","line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}},{"type":"object","name":"WheelZoomTool","id":"p3250"},{"type":"object","name":"ResetTool","id":"p3251"},{"type":"object","name":"HoverTool","id":"p3289","attributes":{"renderers":[{"id":"p3285"}],"tooltips":[["Date Time","@DateTime_Silo{%H:%M %d/%m/%Y}"],["DailyRainfall_Silo","@DailyRainfall_Silo{0.2f}"]],"formatters":{"type":"map","entries":[["@DateTime_Silo","datetime"]]}}},{"type":"object","name":"HoverTool","id":"p3303","attributes":{"renderers":[{"id":"p3299"}],"tooltips":[["Date Time","@DateTime_Daily{%H:%M %d/%m/%Y}"],["Daily_Interp","@Daily{0.2f}"]],"formatters":{"type":"map","entries":[["@DateTime_Daily","datetime"]]}}}],"active_drag":{"id":"p3248"},"active_scroll":{"id":"p3250"}}},"left":[{"type":"object","name":"LinearAxis","id":"p3240","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p3242","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p3241"},"axis_label":"Daily","axis_label_standoff":10,"axis_label_text_color":"#E0E0E0","axis_label_text_font":"Helvetica","axis_label_text_font_size":"1.25em","axis_label_text_font_style":"normal","major_label_policy":{"type":"object","name":"AllLabels","id":"p3243"},"major_label_text_color":"#E0E0E0","major_label_text_font":"Helvetica","major_label_text_font_size":"1.025em","axis_line_color":"#E0E0E0","axis_line_alpha":0,"major_tick_line_color":"#E0E0E0","major_tick_line_alpha":0,"minor_tick_line_color":"#E0E0E0","minor_tick_line_alpha":0}}],"right":[{"type":"object","name":"Legend","id":"p3277","attributes":{"border_line_alpha":0,"background_fill_color":"#20262B","background_fill_alpha":0,"click_policy":"hide","label_text_color":"#E0E0E0","label_text_font":"Helvetica","label_text_font_size":"1.025em","label_standoff":8,"glyph_width":15,"spacing":8,"items":[{"type":"object","name":"LegendItem","id":"p3288","attributes":{"label":{"type":"value","value":"Daily_SILO"},"renderers":[{"id":"p3285"}]}},{"type":"object","name":"LegendItem","id":"p3302","attributes":{"label":{"type":"value","value":"Daily_Interp"},"renderers":[{"id":"p3299"}]}}]}}],"below":[{"type":"object","name":"LinearAxis","id":"p3233","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p3235","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"DatetimeTickFormatter","id":"p3258","attributes":{"minutes":"%H:%M %d/%m/%Y","hours":"%H:%M %d/%m/%Y","days":"%H:%M %d/%m/%Y","months":"%d/%m/%Y","years":"%d/%m/%Y"}},"axis_label_standoff":10,"axis_label_text_color":"#E0E0E0","axis_label_text_font":"Helvetica","axis_label_text_font_size":"1.25em","axis_label_text_font_style":"normal","major_label_policy":{"type":"object","name":"AllLabels","id":"p3236"},"major_label_text_color":"#E0E0E0","major_label_text_font":"Helvetica","major_label_text_font_size":"1.025em","axis_line_color":"#E0E0E0","axis_line_alpha":0,"major_tick_line_color":"#E0E0E0","major_tick_line_alpha":0,"minor_tick_line_color":"#E0E0E0","minor_tick_line_alpha":0}}],"center":[{"type":"object","name":"Grid","id":"p3239","attributes":{"axis":{"id":"p3233"},"grid_line_color":"#E0E0E0","grid_line_alpha":0.25,"minor_grid_line_color":"grey","minor_grid_line_alpha":0.1,"minor_grid_line_dash":[6]}},{"type":"object","name":"Grid","id":"p3246","attributes":{"dimension":1,"axis":{"id":"p3240"},"grid_line_color":"#E0E0E0","grid_line_alpha":0.25,"minor_grid_line_color":"grey","minor_grid_line_alpha":0.1,"minor_grid_line_dash":[6]}},{"id":"p3291"}],"background_fill_color":"#20262B","border_fill_color":"#15191C"}}],["SILOfile_input",{"id":"p3319"}]]},"code":"\n    \n        function StatusTextLoading(){\n            status_text_cleaner_silo.value = 'Loading SILO ref data file ...'\n            status_label_cleaner_silo.text = 'Loading SILO ref data file ...'\n            }\n        \n        function StatusTextComplete(){\n            status_text_cleaner_silo.value = 'SILO File import and pre-cleaning complete.'    \n            status_label_cleaner_silo.text = ' '\n            }\n    \n    \n        // file loading ////////////////////////////////////////////////////\n        function process_file() {\n    \n            var file_contents = cb_obj.value;\n            \n            // read in entire file and decode text\n            const decoded_file_contents = atob(file_contents);\n            const file_lines = decoded_file_contents.split(\"\\n\");\n            \n            // initialise arrays        \n            var DateTime_Silo = [];\n            var DailyRainfall_Silo = [];\n            \n            // read the file data line by line   //////////////////////////////////\n            console.log('  Read file line by line ...')\n            for (var i = 1; i &lt; file_lines.length; i++) {\n            //for (var i = 0; i &lt; 20; i++) {\n                \n                // read a line\n                var line = file_lines[i]\n                line = line.replace('\\r','')\n                // SILO line format 2010  1  1    1      2.6\n                //                  2021 12 31  365      2.6\n                \n                // checks\n                if (line.trim().length === 0 || line.trim() === \"\") {continue}\n                \n                // get the time series data\n                var tmp = line.split(' ')\n                tmp = tmp.filter((str) =&gt; str !== ''); // remove empty strings in split array\n                var rain = parseFloat(tmp[4])\n                DailyRainfall_Silo.push(rain);\n                \n                // make DateTime\n                var year = tmp[0];\n                var month = tmp[1];\n                var day = tmp[2];\n                var hours = 19;  // for 9am + 10hrs GMT\n                var minutes = 0;\n                var tmp = new Date(year, month - 1, day, hours, minutes);\n                console.log(tmp)\n                tmp = Math.floor(tmp.getTime()); // unix timestamp\n                DateTime_Silo.push(tmp)\n\n                } // end of line by line loop\n    \n            // create data source\n            source_silo.data = {DateTime_Silo: DateTime_Silo, DailyRainfall_Silo: DailyRainfall_Silo}; \n            source_silo.change.emit();\n\n            \n        }  // end of process_file function\n    \n        function CallbackTiming(){\n            setTimeout(StatusTextLoading,0);\n            plot_Daily_cleaner.title.text = SILOfile_input.filename;\n            setTimeout(process_file, 1000);\n            setTimeout(StatusTextComplete, 1000);\n            }\n        \n        CallbackTiming()\n        \n    "}}]]]},"width":400,"accept":".txt"}}]}},{"type":"object","name":"Column","id":"p3326","attributes":{"children":[{"id":"p3037"},{"type":"object","name":"Row","id":"p3325","attributes":{"align":"end","children":[{"type":"object","name":"Button","id":"p3307","attributes":{"button_type":"danger","js_event_callbacks":{"type":"map","entries":[["button_click",[{"type":"object","name":"CustomJS","id":"p3308","attributes":{"args":{"type":"map","entries":[["source_clean",{"id":"p2858"}],["source_daily",{"id":"p2867"}],["status_label_cleaner",{"id":"p3127"}],["status_text_cleaner",{"id":"p3128"}]]},"code":"\n                               \n        function StatusTextLoading(){\n            status_text_cleaner.value = 'Reprocessing data ...'\n            status_label_cleaner.text = 'Reprocessing data ...'\n            }\n        \n        function StatusTextComplete(){\n            status_text_cleaner.value = 'Data processing complete.'    \n            status_label_cleaner.text = ' '\n            }\n\n        function processing(){\n                                           \n            var indices = source_clean.selected.indices;\n            if (indices.length == 0) {\n                return;\n            }\n            \n            // declare variables        \n            var data = source_clean.data;\n            var x = data['DateTime_Clean'];\n            var y = data['Rainfall_Clean'];\n            var removed_x = [];\n            var removed_y = [];\n            \n            // remove data and store for later recovery\n            for (var i = 0; i &lt; indices.length; i++) {\n                removed_x.push(x[indices[i]]);\n                removed_y.push(y[indices[i]]);\n            }\n            window.removed_data = {'x': removed_x, 'y': removed_y};\n            \n            \n            var new_x = [];\n            var new_y = [];\n            for (var i = 0; i &lt; x.length; i++) {\n                if (indices.indexOf(i) == -1) {\n                    new_x.push(x[i]);\n                    new_y.push(y[i]);\n                }\n            }\n            \n            // compute cumulative total\n            var new_c = cumulative(new_y)\n            source_clean.data = {'DateTime_Clean': new_x, 'Rainfall_Clean': new_y, 'Cumulative_Clean':new_c};\n            source_clean.selected.indices = [];\n            \n            // \n\n            // ComputeDaily(source_clean, source_daily)\n            let [DateTime_Daily, Cumulative_Daily, Daily]  = ComputeDailyRainfall(new_x, new_c);\n            \n            // update source_daily\n            source_daily.data = {DateTime_Daily: DateTime_Daily, Cumulative_Daily: Cumulative_Daily, Daily: Daily}; \n            source_daily.change.emit();\n            \n\n            } // end of processing function\n\n        function CallbackTiming(){\n            setTimeout(StatusTextLoading,0);\n            setTimeout(processing, 1000);\n            setTimeout(StatusTextComplete, 1000);\n            }\n    \n        CallbackTiming()\n\n        \n    "}}]]]},"label":"Delete Selected Points"}},{"type":"object","name":"Button","id":"p3309","attributes":{"button_type":"warning","js_event_callbacks":{"type":"map","entries":[["button_click",[{"type":"object","name":"CustomJS","id":"p3310","attributes":{"args":{"type":"map","entries":[["source_clean",{"id":"p2858"}],["source_daily",{"id":"p2867"}],["status_label_cleaner",{"id":"p3127"}],["status_text_cleaner",{"id":"p3128"}]]},"code":"\n\n        function StatusTextLoading(){\n            status_text_cleaner.value = 'Undoing last delete ...'\n            status_label_cleaner.text = 'Undoing last delete ...'\n            }\n        \n        function StatusTextComplete(){\n            status_text_cleaner.value = 'Data processing complete.'    \n            status_label_cleaner.text = ' '\n            }\n\n\n        function processing(){\n            \n            var data = source_clean.data;\n            var x = data['DateTime_Clean'];\n            var y = data['Rainfall_Clean'];\n            \n            var removed_x = window.removed_data['x'];\n            var removed_y = window.removed_data['y'];\n            \n            x = x.concat(removed_x); // this puts removed data at the end so need to sort!!\n            y = y.concat(removed_y);\n            \n            // sort data based on x (time)\n            let combined = [];\n            for (let i = 0; i &lt; y.length; i++) {\n              combined.push({ y: y[i], x: x[i] });\n            }\n            combined.sort((a, b) =&gt; a.x - b.x);\n            y = combined.map(point =&gt; point.y);\n            x = combined.map(point =&gt; point.x);\n            \n            // recompute cumulative total\n            var c = cumulative(y)\n            source_clean.data = {'DateTime_Clean': x, 'Rainfall_Clean': y, 'Cumulative_Clean': c};\n            \n            // \n            ComputeDaily(source_clean, source_daily)\n    \n            window.removed_data = null;\n            }\n        \n        function CallbackTiming(){\n            setTimeout(StatusTextLoading,0);\n            setTimeout(processing, 1000);\n            setTimeout(StatusTextComplete, 1000);\n            }\n    \n        CallbackTiming()\n    "}}]]]},"label":"Undo Last Delete"}},{"type":"object","name":"Button","id":"p3311","attributes":{"button_type":"primary","js_event_callbacks":{"type":"map","entries":[["button_click",[{"type":"object","name":"CustomJS","id":"p3312","attributes":{"args":{"type":"map","entries":[["source_clean",{"id":"p2858"}],["source_precleaned",{"id":"p2861"}],["source_daily",{"id":"p2867"}],["status_label_cleaner",{"id":"p3127"}],["status_text_cleaner",{"id":"p3128"}]]},"code":"\n                               \n                                    function StatusTextLoading(){\n                                        status_text_cleaner.value = 'Restoring pre-cleaned data ...'\n                                        status_label_cleaner.text = 'Restoring pre-cleaned data ...'\n                                        }\n                                    \n                                    function StatusTextComplete(){\n                                        status_text_cleaner.value = 'Pre-cleaned data restored.'    \n                                        status_label_cleaner.text = ' '\n                                        }\n                                    \n                                    function processing(){\n                                        source_clean.data = source_precleaned.data;\n                                        source_clean.change.emit();\n                                        ComputeDaily(source_clean, source_daily)\n                                            } // end of processing\n                                    \n                                     function CallbackTiming(){\n                                         setTimeout(StatusTextLoading,0);\n                                         setTimeout(processing, 1000);\n                                         setTimeout(StatusTextComplete, 1000);\n                                         }\n                                     \n                                     CallbackTiming()\n                                       \n                                     "}}]]]},"label":"Restore to Pre-Cleaned Data"}},{"type":"object","name":"Button","id":"p3313","attributes":{"js_event_callbacks":{"type":"map","entries":[["button_click",[{"type":"object","name":"CustomJS","id":"p3314","attributes":{"args":{"type":"map","entries":[["source_clean",{"id":"p2858"}],["source_raw",{"id":"p2855"}],["source_daily",{"id":"p2867"}],["status_label_cleaner",{"id":"p3127"}],["status_text_cleaner",{"id":"p3128"}]]},"code":"\n\n                               function StatusTextLoading(){\n                                   status_text_cleaner.value = 'Restoring to raw data ...'\n                                   status_label_cleaner.text = 'Restoring to raw data ...'\n                                   }\n                               \n                               function StatusTextComplete(){\n                                   status_text_cleaner.value = 'Raw data restored.'    \n                                   status_label_cleaner.text = ' '\n                                   }\n\n                                function processing(){\n\n                                       var data = source_raw.data;\n                                       var x = data['DateTime_Raw'];\n                                       var y = data['Rainfall_Raw'];\n                                       \n                                       // sort data based on x (time)\n                                       let combined = [];\n                                       for (let i = 0; i &lt; y.length; i++) {\n                                         combined.push({ y: y[i], x: x[i] });\n                                       }\n                                       combined.sort((a, b) =&gt; a.x - b.x);\n                                       y = combined.map(point =&gt; point.y);\n                                       x = combined.map(point =&gt; point.x);\n                                       \n                                       // recompute cumulative total\n                                       var c = cumulative(y);\n                                       \n                                    // update source\n                                    source_clean.data = {DateTime_Clean: x, Rainfall_Clean: y, Cumulative_Clean: c};\n                                    source_clean.change.emit();\n                                   \n                                    // \n                                    ComputeDaily(source_clean, source_daily)\n                                    }\n                                \n                                function CallbackTiming(){\n                                    setTimeout(StatusTextLoading,0);\n                                    setTimeout(processing, 1000);\n                                    setTimeout(StatusTextComplete, 1000);\n                                    }\n                            \n                                CallbackTiming()\n\n                               "}}]]]},"label":"Restore to Raw Data"}},{"type":"object","name":"Button","id":"p3315","attributes":{"button_type":"success","js_event_callbacks":{"type":"map","entries":[["button_click",[{"type":"object","name":"CustomJS","id":"p3316","attributes":{"args":{"type":"map","entries":[["source_clean",{"id":"p2858"}],["status_label_cleaner",{"id":"p3127"}],["status_text_cleaner",{"id":"p3128"}],["csvfile_input",{"id":"p3305"}]]},"code":"\n\n                                  function StatusTextLoading(){\n                                      status_text_cleaner.value = 'Exporting cleaned data ...'\n                                      status_label_cleaner.value = 'Exporting cleaned data ...'\n                                      }\n                                  \n                                  function StatusTextComplete(){\n                                      status_text_cleaner.value = 'Data export complete.'    \n                                      status_label_cleaner.text = ' '\n                                      }\n\n                                   function processing(){\n                                        \n                                        var data = source_clean.data;\n                                        var x = data['DateTime_Clean'];\n                                        var y = data['Rainfall_Clean'];\n                                        var c = data['Cumulative_Clean'];\n                                        \n                                \n                                        var csv_data = 'DateTime,Cumulative Rainfall\\n';\n                                        for (var i = 0; i &lt; x.length; i++) {\n                                            var date = new Date(x[i]);\n                                            var formatted_timestamp = date.toLocaleDateString() + \" \" + date.toLocaleTimeString();\n                                            csv_data += formatted_timestamp + ',' + c[i] + '\\n';\n                                        }\n                                        \n                                        var blob = new Blob([csv_data], { type: 'text/csv;charset=utf-8;' });\n                                        var link = document.createElement(\"a\");\n                                        if (link.download !== undefined) {\n                                            link.setAttribute(\"href\", window.URL.createObjectURL(blob));\n                                            var csvFile = csvfile_input.filename.slice(0,csvfile_input.filename.length-4)+'_Cleaned.csv'\n                                            link.setAttribute(\"download\", csvFile);\n                                            link.style.visibility = 'hidden';\n                                            document.body.appendChild(link);\n                                            link.click();\n                                            document.body.removeChild(link);\n                                        }                                       \n                                        }\n                                   \n                                   function CallbackTiming(){\n                                       setTimeout(StatusTextLoading,0);\n                                       setTimeout(processing, 1000);\n                                       setTimeout(StatusTextComplete, 1000);\n                                       }\n                               \n                                   CallbackTiming()\n\n\n    "}}]]]},"label":"Export Cleaned Data"}},{"type":"object","name":"Button","id":"p3317","attributes":{"js_event_callbacks":{"type":"map","entries":[["button_click",[{"type":"object","name":"CustomJS","id":"p3318","attributes":{"args":{"type":"map","entries":[["source_clean",{"id":"p2858"}],["source_raw",{"id":"p2855"}],["source_daily",{"id":"p2867"}],["status_label_cleaner",{"id":"p3127"}],["status_text_cleaner",{"id":"p3128"}],["plot_cleaner",{"id":"p3037"}],["csvfile_input",{"id":"p3305"}]]},"code":"\n\n                                    // update source\n                                    source_clean.data = {DateTime_Clean: [], Rainfall_Clean: [], Cumulative_Clean: []};\n                                    source_clean.change.emit();\n\n                                    source_raw.data = {DateTime_Raw: [], Rainfall_Raw: []};\n                                    source_raw.change.emit();\n                                    \n                                    source_daily.data = {DateTime_Daily: [], Cumulative_Daily: [], Daily: []};\n                                    source_daily.change.emit();\n\n                                    plot_cleaner.title.text = ' ';\n\n                                   // csvfile_input.value = [ ];\n                                   status_text_cleaner.value = 'Waiting for a new file input. \\n To reload the previous file you need to first refresh the page.'\n                                   status_label_cleaner.text = 'Waiting for a new file input. \\n To reload the previous file you need to first refresh the page.'\n                                   \n                                   //var new_file_input = new Bokeh.Models.FileInput({accept: \".csv\", id: \"file-input\" + new Date().getTime()});\n                                   //csvfile_input = new_file_input;\n\n                               "}}]]]},"label":"Clear All Data"}}]}},{"type":"object","name":"Figure","id":"p3129","attributes":{"width":1000,"height":200,"x_range":{"id":"p3039"},"y_range":{"type":"object","name":"DataRange1d","id":"p3131"},"x_scale":{"type":"object","name":"LinearScale","id":"p3141"},"y_scale":{"type":"object","name":"LinearScale","id":"p3143"},"title":{"type":"object","name":"Title","id":"p3137","attributes":{"text_color":"#E0E0E0","text_font":"Helvetica","text_font_size":"1.15em"}},"outline_line_color":"#E0E0E0","outline_line_alpha":0.25,"renderers":[{"type":"object","name":"GlyphRenderer","id":"p3198","attributes":{"data_source":{"id":"p2858"},"view":{"type":"object","name":"CDSView","id":"p3199","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p3200"}}},"glyph":{"type":"object","name":"Line","id":"p3195","attributes":{"x":{"type":"field","field":"DateTime_Clean"},"y":{"type":"field","field":"Cumulative_Clean"},"line_color":"#ff7f0e","line_width":2}},"nonselection_glyph":{"type":"object","name":"Line","id":"p3196","attributes":{"x":{"type":"field","field":"DateTime_Clean"},"y":{"type":"field","field":"Cumulative_Clean"},"line_color":"#ff7f0e","line_alpha":0.1,"line_width":2}},"muted_glyph":{"type":"object","name":"Line","id":"p3197","attributes":{"x":{"type":"field","field":"DateTime_Clean"},"y":{"type":"field","field":"Cumulative_Clean"},"line_color":"#ff7f0e","line_alpha":0.2,"line_width":2}}}},{"type":"object","name":"GlyphRenderer","id":"p3210","attributes":{"data_source":{"id":"p2867"},"view":{"type":"object","name":"CDSView","id":"p3211","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p3212"}}},"glyph":{"type":"object","name":"Line","id":"p3207","attributes":{"x":{"type":"field","field":"DateTime_Daily"},"y":{"type":"field","field":"Cumulative_Daily"},"line_color":"#98df8a","line_width":2}},"nonselection_glyph":{"type":"object","name":"Line","id":"p3208","attributes":{"x":{"type":"field","field":"DateTime_Daily"},"y":{"type":"field","field":"Cumulative_Daily"},"line_color":"#98df8a","line_alpha":0.1,"line_width":2}},"muted_glyph":{"type":"object","name":"Line","id":"p3209","attributes":{"x":{"type":"field","field":"DateTime_Daily"},"y":{"type":"field","field":"Cumulative_Daily"},"line_color":"#98df8a","line_alpha":0.2,"line_width":2}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p3133","attributes":{"logo":null,"tools":[{"type":"object","name":"PanTool","id":"p3159"},{"type":"object","name":"BoxZoomTool","id":"p3160","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p3161","attributes":{"syncable":false,"level":"overlay","visible":false,"left_units":"canvas","right_units":"canvas","bottom_units":"canvas","top_units":"canvas","line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}},{"type":"object","name":"WheelZoomTool","id":"p3162"},{"type":"object","name":"ResetTool","id":"p3163"},{"type":"object","name":"HoverTool","id":"p3202","attributes":{"renderers":[{"id":"p3198"}],"tooltips":[["Date Time","@DateTime_Clean{%H:%M %d/%m/%Y}"],["Cumulative_Clean","@Cumulative_Clean{0.1f}"]],"formatters":{"type":"map","entries":[["@DateTime_Clean","datetime"]]}}},{"type":"object","name":"HoverTool","id":"p3214","attributes":{"renderers":[{"id":"p3210"}],"tooltips":[["Date Time","@DateTime_Daily{%H:%M %d/%m/%Y}"],["Cumulative_Daily","@Cumulative_Daily{0.1f}"]],"formatters":{"type":"map","entries":[["@DateTime_Daily","datetime"]]}}}],"active_drag":{"id":"p3160"},"active_scroll":{"id":"p3162"}}},"left":[{"type":"object","name":"LinearAxis","id":"p3152","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p3154","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p3153"},"axis_label":"Cumulative Rainfall","axis_label_standoff":10,"axis_label_text_color":"#E0E0E0","axis_label_text_font":"Helvetica","axis_label_text_font_size":"1.25em","axis_label_text_font_style":"normal","major_label_policy":{"type":"object","name":"AllLabels","id":"p3155"},"major_label_text_color":"#E0E0E0","major_label_text_font":"Helvetica","major_label_text_font_size":"1.025em","axis_line_color":"#E0E0E0","axis_line_alpha":0,"major_tick_line_color":"#E0E0E0","major_tick_line_alpha":0,"minor_tick_line_color":"#E0E0E0","minor_tick_line_alpha":0}}],"right":[{"type":"object","name":"Legend","id":"p3191","attributes":{"border_line_alpha":0,"background_fill_color":"#20262B","background_fill_alpha":0,"click_policy":"hide","label_text_color":"#E0E0E0","label_text_font":"Helvetica","label_text_font_size":"1.025em","label_standoff":8,"glyph_width":15,"spacing":8,"items":[{"type":"object","name":"LegendItem","id":"p3201","attributes":{"label":{"type":"value","value":"Cumulative_Clean"},"renderers":[{"id":"p3198"}]}},{"type":"object","name":"LegendItem","id":"p3213","attributes":{"label":{"type":"value","value":"Cumulative_Daily"},"renderers":[{"id":"p3210"}]}}]}},{"type":"object","name":"Legend","id":"p3278","attributes":{"border_line_alpha":0,"background_fill_color":"#20262B","background_fill_alpha":0,"label_text_color":"#E0E0E0","label_text_font":"Helvetica","label_text_font_size":"1.025em","label_standoff":8,"glyph_width":15,"spacing":8}}],"below":[{"type":"object","name":"LinearAxis","id":"p3145","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p3147","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"DatetimeTickFormatter","id":"p3170","attributes":{"minutes":"%H:%M %d/%m/%Y","hours":"%H:%M %d/%m/%Y","days":"%H:%M %d/%m/%Y","months":"%d/%m/%Y","years":"%d/%m/%Y"}},"axis_label_standoff":10,"axis_label_text_color":"#E0E0E0","axis_label_text_font":"Helvetica","axis_label_text_font_size":"1.25em","axis_label_text_font_style":"normal","major_label_policy":{"type":"object","name":"AllLabels","id":"p3148"},"major_label_text_color":"#E0E0E0","major_label_text_font":"Helvetica","major_label_text_font_size":"1.025em","axis_line_color":"#E0E0E0","axis_line_alpha":0,"major_tick_line_color":"#E0E0E0","major_tick_line_alpha":0,"minor_tick_line_color":"#E0E0E0","minor_tick_line_alpha":0}}],"center":[{"type":"object","name":"Grid","id":"p3151","attributes":{"axis":{"id":"p3145"},"grid_line_color":"#E0E0E0","grid_line_alpha":0.25,"minor_grid_line_color":"grey","minor_grid_line_alpha":0.1,"minor_grid_line_dash":[6]}},{"type":"object","name":"Grid","id":"p3158","attributes":{"dimension":1,"axis":{"id":"p3152"},"grid_line_color":"#E0E0E0","grid_line_alpha":0.25,"minor_grid_line_color":"grey","minor_grid_line_alpha":0.1,"minor_grid_line_dash":[6]}}],"background_fill_color":"#20262B","border_fill_color":"#15191C"}},{"id":"p3216"}]}}]}}}}]}}],"callbacks":{"type":"map"}}}
    </script>
    <script type="text/javascript">
      (function() {
        const fn = function() {
          Bokeh.safely(function() {
            (function(root) {
              function embed_document(root) {
              const docs_json = document.getElementById('p3772').textContent;
              const render_items = [{"docid":"ff42662e-be0b-4ea8-a162-66fcd75703d8","roots":{"p3507":"dc4007a9-e22b-4f5f-9925-bc715d4bd31c"},"root_ids":["p3507"]}];
              root.Bokeh.embed.embed_items(docs_json, render_items);
              }
              if (root.Bokeh !== undefined) {
                embed_document(root);
              } else {
                let attempts = 0;
                const timer = setInterval(function(root) {
                  if (root.Bokeh !== undefined) {
                    clearInterval(timer);
                    embed_document(root);
                  } else {
                    attempts++;
                    if (attempts > 100) {
                      clearInterval(timer);
                      console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                    }
                  }
                }, 10, root)
              }
            })(window);
          });
        };
        if (document.readyState != "loading") fn();
        else document.addEventListener("DOMContentLoaded", fn);
      })();
    </script>
  </body>
</html>